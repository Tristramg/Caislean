- name: Install VPN-related packages
  apt: pkg={{item}} state=installed
  with_items:
    - openvpn
    - dnsmasq

- name: Install OpenVPN server configuration
  copy: src=etc/openvpn/server.conf dest=/etc/openvpn/server.conf owner=root group=root mode=0644

- name: Install OpenVPN scripts
  copy: src={{item}} dest=/etc/openvpn/ owner=root group=root mode=0755
  with_fileglob:
    - etc/openvpn/server-*.sh

- name: Allow VPN traffic by firewall
  ufw: rule=allow interface=tun+
